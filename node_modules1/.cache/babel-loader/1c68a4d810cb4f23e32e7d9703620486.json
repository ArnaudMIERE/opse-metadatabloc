{"remainingRequest":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/babel-loader/lib/index.js!/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/src/lib/modules/opse-images-displayed-block/opse-images-displayed-block.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/src/lib/modules/opse-images-displayed-block/opse-images-displayed-block.vue","mtime":1644931879509},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/babel.config.js","mtime":1644331050195},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgYXBwbHlQcmltYXJ5QW5kU2Vjb25kYXJ5Q29sb3JzIH0gZnJvbSAiLi4vLi4vdXRpbHMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIm9wc2UtaW1hZ2VzLWRpc3BsYXllZC1ibG9jayIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNpemU6IDQsCiAgICAgIGRhdGFQb2xpY3k6IGZhbHNlLAogICAgICBjdXJyZW50U3RhdHVzOiAiUFJFUEFSSU5HX1JFUVVFU1QiLAogICAgICBpbWFnZTogMCwKICAgICAgeWVhcnM6IFtdLAogICAgICBpbWFnZXM6IFtdCiAgICB9OwogIH0sCiAgcHJvcHM6IHsKICAgIGxhbmd1YWdlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogImVuIgogICAgfSwKICAgIHRoZW1lOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHByaW1hcnlDb2xvcjogIiNGMzlDMTIiLAogICAgICAgICAgc2Vjb25kYXJ5Q29sb3I6ICIjQUFBIgogICAgICAgIH07CiAgICAgIH0KICAgIH0sCiAgICBtZXRhZGF0YTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGFwcGx5VGhlbWU6IGZ1bmN0aW9uIGFwcGx5VGhlbWUoKSB7CiAgICAgIHJldHVybiBhcHBseVByaW1hcnlBbmRTZWNvbmRhcnlDb2xvcnModGhpcy50aGVtZSk7CiAgICB9LAogICAgaXNWaXNpYmxlOiBmdW5jdGlvbiBpc1Zpc2libGUoKSB7CiAgICAgIHZhciBpc1Zpc2libGUgPSBmYWxzZTsKCiAgICAgIGlmICh0aGlzLnVybCAhPSBudWxsKSB7CiAgICAgICAgaXNWaXNpYmxlID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdGhpcy4kZW1pdCgiZ2V0VmlzaWJpbGl0eSIsIHsKICAgICAgICBuYW1lOiB0aGlzLiRvcHRpb25zLm5hbWUsCiAgICAgICAgcHJvZ3JhbW1hdGljU2Nyb2xsaW5nVGl0bGU6IHRoaXMuJHQoIm9wc2VEb3dubG9hZCIpLAogICAgICAgIGlzVmlzaWJsZTogaXNWaXNpYmxlCiAgICAgIH0pOwogICAgICByZXR1cm4gaXNWaXNpYmxlOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIG1ldGFkYXRhOiBmdW5jdGlvbiBtZXRhZGF0YSgpIHsKICAgICAgdGhpcy5sb2FkUGhvdG9zKCk7CiAgICB9LAogICAgbGFuZ3VhZ2U6IGZ1bmN0aW9uIGxhbmd1YWdlKHZhbHVlKSB7CiAgICAgIHRoaXMuJGkxOG4ubG9jYWxlID0gdmFsdWU7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy4kaTE4bi5sb2NhbGUgPSB0aGlzLmxhbmd1YWdlOwogICAgdGhpcy5maWxlKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBmaWxlOiBmdW5jdGlvbiBmaWxlKCkgewogICAgICB0aGlzLmxvYWRQaG90b3ModGhpcy5mb2xkZXJGaWxlKTsKICAgIH0sCiAgICBsb2FkUGhvdG9zOiBmdW5jdGlvbiBsb2FkUGhvdG9zKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHVybCA9IG51bGw7CgogICAgICBpZiAodGhpcy5tZXRhZGF0YSAmJiB0aGlzLm1ldGFkYXRhLmxpbmtzICYmIHRoaXMubWV0YWRhdGEubGlua3MubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZXRhZGF0YS5saW5rcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMubWV0YWRhdGEubGlua3NbaV0udHlwZSA9PSAiT1BFTlNFQVJDSF9MSU5LIikgewogICAgICAgICAgICB1cmwgPSB0aGlzLm1ldGFkYXRhLmxpbmtzW2ldLnVybDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnVybCA9IHVybDsKCiAgICAgIGlmICh1cmwgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgY29uc29sZS5sb2coInVybCAiLCB0aGlzLnVybCArICJkYXRhL3YxXzAvcGhvdG9zP2NvbGxlY3Rpb249IiArIHRoaXMubWV0YWRhdGEuaWQpOwogICAgICB0aGlzLmF4aW9zKHsKICAgICAgICBtZXRob2Q6ICJnZXQiLAogICAgICAgIHVybDogdGhpcy51cmwgKyAiZGF0YS92MV8wL3Bob3Rvcz9jb2xsZWN0aW9uPSIgKyB0aGlzLm1ldGFkYXRhLmlkIC8vdXJsOiB0aGlzLnVybCArICIvcmVxdWVzdD9jb2xsZWN0aW9uPSIrdGhpcy5tZXRhZGF0YS5pZCwKCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMueWVhcnMgPSBbXTsKICAgICAgICBfdGhpcy5pbWFnZXMgPSBbXTsKICAgICAgICBfdGhpcy5zaXplID0gMDsKICAgICAgICBjb25zb2xlLmxvZygiUmVzcG9uc2UiLCByZXNwb25zZS5kYXRhKTsKCiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHJlc3BvbnNlLmRhdGEuZW50cmllcy5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgIF90aGlzLnNpemUgPSByZXNwb25zZS5kYXRhLmVudHJpZXMubGVuZ3RoIC0gMTsKCiAgICAgICAgICBfdGhpcy55ZWFycy5wdXNoKHJlc3BvbnNlLmRhdGEuZW50cmllc1tfaV0uZGF0ZS5zdWJzdHJpbmcoMCwgNCkpOwoKICAgICAgICAgIF90aGlzLmltYWdlcy5wdXNoKCJkYXRhOmltYWdlL2pwZztiYXNlNjQsIiArIHJlc3BvbnNlLmRhdGEuZW50cmllc1tfaV0uaW1hZ2UpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgLy8gdGhpcy5kaXNwbGF5RXJyb3IoIkFuIGVycm9yIGhhcyBvY2N1cmVkOiIgKyBlcnJvcikKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;AACAA,qCADA;AAGAC,MAHA,kBAGA;AACA;AACAC,aADA;AAEAC,uBAFA;AAGAC,wCAHA;AAIAC,cAJA;AAKAC,eALA;AAMAC;AANA;AAQA,GAZA;AAcAC;AACAC;AACAC,kBADA;AAEAC;AAFA,KADA;AAKAC;AACAF,kBADA;AAEAC;AACA;AACAE,iCADA;AAEAC;AAFA;AAIA;AAPA,KALA;AAeAC;AACAL,kBADA;AAEAC;AACA;AACA;AAJA;AAfA,GAdA;AAqCAK;AACAC,cADA,wBACA;AACA;AACA,KAHA;AAKAC,aALA,uBAKA;AACA;;AACA;AACAA;AACA;;AAEA;AACAlB,gCADA;AAEAmB,2DAFA;AAGAD;AAHA;AAKA;AACA;AAjBA,GArCA;AAyDAE;AACAL,YADA,sBACA;AACA;AACA,KAHA;AAIAN,YAJA,oBAIAY,KAJA,EAIA;AACA;AACA;AANA,GAzDA;AAkEAC,SAlEA,qBAkEA;AACA;AACA;AACA,GArEA;AAuEAC;AACAC,QADA,kBACA;AACA;AACA,KAHA;AAKAC,cALA,wBAKA;AAAA;;AACA;;AACA,UACA,iBACA,mBADA,IAEA,8BAHA,EAIA;AACA;AACA;AACAC;AACA;AACA;AACA;AACA;;AACA;;AACA;AACA;AACA;;AAEA;AACAC,kBACA,MADA,EAEA,WACA,8BADA,GAEA,gBAJA;AAMA;AACAC,qBADA;AAEAF,aACA,WACA,8BADA,GAEA,gBALA,CAMA;;AANA,SAQAG,IARA,CAQA;AACA;AACA;AACA;AACAF;;AAEA;AACA;;AACA;;AACA;AACA;AACA,OAnBA,EAoBAG,KApBA,CAoBA;AACA;AACAH;AACA,OAvBA,EAwBAI,OAxBA,CAwBA;AACA;AACA,OA1BA;AA2BA;AA1DA;AAvEA","names":["name","data","size","dataPolicy","currentStatus","image","years","images","props","language","type","default","theme","primaryColor","secondaryColor","metadata","computed","applyTheme","isVisible","programmaticScrollingTitle","watch","value","created","methods","file","loadPhotos","url","console","method","then","catch","finally"],"sourceRoot":"src/lib/modules/opse-images-displayed-block","sources":["opse-images-displayed-block.vue"],"sourcesContent":["<i18n  >\n{\n  \"en\": {\n    \"opseAccessData\": \"Data access\",\n    \"opseDisplayedImg\": \"Data displayed Image\",\n    \"opseDownload\": \"Download\",\n    \"explicationText\": \"Select the years you want to download (all years are selected by default).\",\n    \"explicationTextParams\": \"Select the params you want to download (all params are selected by default).\",\n    \"year\": \"Year\",\n    \"param\": \"Parameter\",\n    \"downloadAll\": \"Download All years\",\n    \"downloadSelected\": \"Download selected years\",\n    \"opseAlert\":\"No data available yet.\"        \n\n  },\n  \"fr\": {\n    \"opseAccessData\": \"Accès aux données\",\n    \"opseDisplayedImg\": \"Affichage des données\",\n    \"opseDownload\": \"Téléchargement\",\n    \"explicationText\": \"Selectionnez les années que vous voulez télécharger (toutes les années sont sélectionées par défaut).\",\n    \"explicationTextParams\": \"Selectionnez les paramètres que vous voulez télécharger (tous les paramètres sont sélectionés par défaut).\",\n    \"year\": \"Année\",\n    \"param\": \"Parametre\",\n    \"downloadAll\": \"Télécharger\",\n    \"downloadSelected\": \"Télécharger la sélection\",\n    \"opseAlert\":\"Aucune donnée n'est encore disponible.\"\n    \n\n  }\n}\n</i18n>\n\n<template>\n  <div>\n    <v-card v-if=\"isVisible\" :style=\"applyTheme\" :flat=\"true\">\n      <v-card-title>\n        <!-- <v-icon large left style=\"color: #f39c12\">mdi-database</v-icon> -->\n        <span>{{ $t(\"opseDisplayedImg\") }}</span>\n      </v-card-title>\n\n      <article>\n        <v-card\n        class=\"mx-auto my-auto\"\n            max-width=\"500\"\n        >\n          <v-subheader>Tick labels</v-subheader>\n\n          <v-card-text>\n            <v-slider\n              v-model=\"image\"\n              :max=\"size\"\n              step=\"1\"\n              ticks=\"always\"\n              persistent-hint\n              thumb-label=\"always\"\n            >\n              <template v-slot:thumb-label=\"{ value }\">\n                {{ years[value] }}\n              </template>\n            </v-slider>\n            <v-img :src=\"images[image]\"> </v-img>\n          </v-card-text>\n        </v-card>\n      </article>\n    </v-card>\n  </div>\n</template>\n\n<script>\nimport { applyPrimaryAndSecondaryColors } from \"../../utils\";\nexport default {\n  name: \"opse-images-displayed-block\",\n\n  data() {\n    return {\n      size : 4,\n      dataPolicy: false,\n      currentStatus: \"PREPARING_REQUEST\",\n      image: 0,\n      years: [],\n      images:[]\n    };\n  },\n\n  props: {\n    language: {\n      type: String,\n      default: \"en\",\n    },\n    theme: {\n      type: Object,\n      default: () => {\n        return {\n          primaryColor: \"#F39C12\",\n          secondaryColor: \"#AAA\",\n        };\n      },\n    },\n\n    metadata: {\n      type: Object,\n      default: () => {\n        return {};\n      },\n    },\n  },\n\n  computed: {\n    applyTheme() {\n      return applyPrimaryAndSecondaryColors(this.theme);\n    },\n\n    isVisible() {\n      let isVisible = false;\n      if (this.url != null) {\n        isVisible = true;\n      }\n\n      this.$emit(\"getVisibility\", {\n        name: this.$options.name,\n        programmaticScrollingTitle: this.$t(\"opseDownload\"),\n        isVisible,\n      });\n      return isVisible;\n    },\n  },\n\n  watch: {\n    metadata() {\n      this.loadPhotos();\n    },\n    language(value) {\n      this.$i18n.locale = value;\n    },\n  },\n\n  created() {\n    this.$i18n.locale = this.language;\n    this.file();\n  },\n\n  methods: {\n    file() {\n      this.loadPhotos(this.folderFile);\n    },\n\n    loadPhotos() {\n      let url = null;\n      if (\n        this.metadata &&\n        this.metadata.links &&\n        this.metadata.links.length > 0\n      ) {\n        for (let i = 0; i < this.metadata.links.length; i++) {\n          if (this.metadata.links[i].type == \"OPENSEARCH_LINK\") {\n            url = this.metadata.links[i].url;\n            break;\n          }\n        }\n      }\n      this.url = url;\n      if (url == null) {\n        return;\n      }\n\n      this.loading = true;\n      console.log(\n        \"url \",\n        this.url +\n          \"data/v1_0/photos?collection=\" +\n          this.metadata.id\n      );\n      this.axios({\n        method: \"get\",\n        url:\n          this.url +\n          \"data/v1_0/photos?collection=\" +\n          this.metadata.id\n        //url: this.url + \"/request?collection=\"+this.metadata.id,\n      })\n        .then((response) => {\n          this.years = [];\n          this.images = [];\n          this.size=0;\n          console.log(\"Response\", response.data);\n\n          for (let i = 0; i < response.data.entries.length; i++) {\n            this.size = response.data.entries.length -1;\n            this.years.push(response.data.entries[i].date.substring(0, 4));\n            this.images.push(\"data:image/jpg;base64,\"+response.data.entries[i].image);\n          }\n        })\n        .catch((error) => {\n          // this.displayError(\"An error has occured:\" + error)\n          console.log(error);\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    },\n  },\n};\n</script>\n"]}]}