{"remainingRequest":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/src/lib/modules/opse-datasetname-block/opse-datasetname-block.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/src/lib/modules/opse-datasetname-block/opse-datasetname-block.vue","mtime":1644331050199},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/openopse/Documents/GitHub/Catalogue Sedoo/projets/opse-metadatabloc/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBZXJpc01ldGFkYXRhTGF5b3V0IGZyb20gIi4uL2FlcmlzLW1ldGFkYXRhLXVpL2FlcmlzLW1ldGFkYXRhLWxheW91dC9hZXJpcy1tZXRhZGF0YS1sYXlvdXQudnVlIgppbXBvcnQgQWVyaXNNZXRhZGF0YURpYWxvZ0xheW91dCBmcm9tICIuLi9hZXJpcy1tZXRhZGF0YS11aS9hZXJpcy1tZXRhZGF0YS1sYXlvdXQvYWVyaXMtbWV0YWRhdGEtZGlhbG9nLWxheW91dC52dWUiOwppbXBvcnQgeyBhcHBseVByaW1hcnlBbmRTZWNvbmRhcnlDb2xvcnMsIGZvcm1hdEVkaXRlZERhdGEsIGJhZFBhdGNoVG9SZW1vdmVQYXJhZ3JhcGhUYWcgfSBmcm9tICIuLi8uLi91dGlscyI7CmltcG9ydCBjbG9uZURlZXAgZnJvbSAibG9kYXNoL2Nsb25lRGVlcCI7CmltcG9ydCBtYXJrZWQgZnJvbSAibWFya2VkIgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ29wc2UtZGF0YXNldG5hbWUtYmxvY2snLAoKICBjb21wb25lbnRzOiB7CiAgICBBZXJpc01ldGFkYXRhTGF5b3V0LAogICAgQWVyaXNNZXRhZGF0YURpYWxvZ0xheW91dAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc0Rpc3BsYXlpbmdEaWFsb2dFZGl0aW9uRm9ybTogZmFsc2UsCiAgICAgIGVkaXRlZERlc2NyaXB0aW9uczpudWxsLAogICAgICBpc0Zvcm1WYWxpZDogdHJ1ZSwKICAgICAgZGlhbG9nOmZhbHNlLAogICAgICB0ZXh0QXJlYVJ1bGVzOiBbdiA9PiAhIXYgfHwgIkNvbnRlbnQgaXMgcmVxdWlyZWQiXSwKCiAgICB9CiAgfSwKCiAgcHJvcHM6IHsKICAgIGxhbmd1YWdlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogImVuIgogICAgfSwKICAgIHRoZW1lOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7ICAgICAgICAKICAgICAgICBwcmltYXJ5Q29sb3I6ICIjRjM5QzEyIiwKICAgICAgICBzZWNvbmRhcnlDb2xvcjogIiNBQUEifTsKICAgICAgfQogICAgfSwKICAgIHNlcnZpY2U6IG51bGwsCiAgICBkb3dubG9hZFVybDogbnVsbCwKICAgIG1ldGFkYXRhOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSwKCiAgICBtYXJrZG93bjp7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCgogICAgaXNFZGl0aW9uQWxsb3dlZDp7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9CiAgICAKICB9LAoKICBjb21wdXRlZDogewogICAgYXBwbHlUaGVtZSgpIHsKICAgICAgcmV0dXJuIGFwcGx5UHJpbWFyeUFuZFNlY29uZGFyeUNvbG9ycyh0aGlzLnRoZW1lKTsKICAgIH0sCgogICAgaXNWaXNpYmxlKCkgewogICAgICBjb25zdCBpc1Zpc2libGUgPSB0aGlzLmlzRWRpdGlvbkFsbG93ZWQgfHwgISF0aGlzLmdldFJlc291cmNlRGF0YXNldE5hbWVzOwogICAgICB0aGlzLiRlbWl0KCJnZXRWaXNpYmlsaXR5IiwgewogICAgICAgIG5hbWU6IHRoaXMuJG9wdGlvbnMubmFtZSwKICAgICAgICBwcm9ncmFtbWF0aWNTY3JvbGxpbmdUaXRsZTogdGhpcy4kdCgib3BzZURhdGFzZXROYW1lIiksCiAgICAgICAgaXNWaXNpYmxlCiAgICAgIH0pOwogICAgICByZXR1cm4gaXNWaXNpYmxlOwogICAgfSwKCiAgIAogICAgY2FuU2hvd0VkaXRJY29uKCkgewogICAgICByZXR1cm4gdGhpcy5pc0VkaXRpb25BbGxvd2VkICYmICF0aGlzLmlzRGlzcGxheWluZ0RpYWxvZ0VkaXRpb25Gb3JtOwogICAgfSwKICAgIGNhbkRpc3BsYXlFZGl0aW9uRm9ybSgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNFZGl0aW9uQWxsb3dlZCAmJiB0aGlzLmlzRGlzcGxheWluZ0RpYWxvZ0VkaXRpb25Gb3JtOwogICAgfSwKCiAgICBtZXRhZGF0YUxhbmd1YWdlKCl7CiAgICAgIGlmICh0aGlzLm1ldGFkYXRhKXsKICAgICAgICBpZiAodGhpcy5tZXRhZGF0YS5sYW5ndWFnZSl7CiAgICAgICAgICByZXR1cm4gdGhpcy5tZXRhZGF0YS5sYW5ndWFnZQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpcy5sYW5ndWFnZQogICAgfSwKCiAgIAogICAgZ2V0UmVzb3VyY2VEYXRhc2V0TmFtZSgpewogICAgICBsZXQgYXV4ID0gdGhpcy5nZXRSZXNvdXJjZURhdGFzZXROYW1lczsKICAgICAgbGV0IHJlc3VsdCA9IGF1eFt0aGlzLmxhbmd1YWdlXTsKICAgICAgaWYgKCghcmVzdWx0KSB8fCAocmVzdWx0LnRyaW0oKS5sZW5ndGggPT0wKSl7CiAgICAgICAgcmV0dXJuIGF1eFt0aGlzLm1ldGFkYXRhTGFuZ3VhZ2VdCiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICAKICAgIGdldFJlc291cmNlRGF0YXNldE5hbWVzKCkgewogICAgICBjb25zdCByZXNvdXJjZURhdGFzZXROYW1lID0gY2xvbmVEZWVwKHRoaXMubWV0YWRhdGEucmVzb3VyY2VEYXRhc2V0TmFtZSk7CiAgICAgIGlmIChyZXNvdXJjZURhdGFzZXROYW1lKSB7CiAgICAgICAgaWYgKHRoaXMubWFya2Rvd24pIHsKICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gcmVzb3VyY2VEYXRhc2V0TmFtZSkgewogICAgICAgICAgICBpZiAocmVzb3VyY2VEYXRhc2V0TmFtZS5oYXNPd25Qcm9wZXJ0eShpdGVtKSkgewogICAgICAgICAgICAgIHJlc291cmNlRGF0YXNldE5hbWVbaXRlbV0gPSBtYXJrZWQoCiAgICAgICAgICAgICAgICB0aGlzLmFkZFNwYWNlcyhyZXNvdXJjZURhdGFzZXROYW1lW2l0ZW1dKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc291cmNlRGF0YXNldE5hbWU7CiAgICB9CiAgfSwKCiAgd2F0Y2g6IHsKICAgIGxhbmd1YWdlKHZhbHVlKSB7CiAgICAgIHRoaXMuJGkxOG4ubG9jYWxlID0gdmFsdWU7CiAgICB9CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgdGhpcy4kaTE4bi5sb2NhbGUgPSB0aGlzLmxhbmd1YWdlOwogIH0sCgogIAoKICBtZXRob2RzOiB7CiAgICAKICAgIGFkZFNwYWNlcyh2YWx1ZSkgewogICAgICBsZXQgYXV4ID0gdmFsdWUucmVwbGFjZSgvIy9nLCAiIyAiKTsKICAgICAgYXV4ID0gYXV4LnJlcGxhY2UoLyMgIy9nLCAiIyMiKTsKICAgICAgYXV4ID0gYXV4LnJlcGxhY2UoLyMgIy9nLCAiIyMiKTsKICAgICAgcmV0dXJuIGF1eDsKICAgIH0sCiAgCgogIGRpc3BsYXlFZGl0aW9uRm9ybSgpIHsKICAgICAgaWYgKCF0aGlzLm1ldGFkYXRhLnJlc291cmNlRGF0YXNldE5hbWUpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy5tZXRhZGF0YSwgInJlc291cmNlRGF0YXNldE5hbWUiLCB7ZW46ICIiLCBmcjogIiJ9KQogICAgICB9CiAgICAgIHRoaXMuZWRpdGVkRGVzY3JpcHRpb25zID0gY2xvbmVEZWVwKHRoaXMubWV0YWRhdGEucmVzb3VyY2VEYXRhc2V0TmFtZSk7CiAgICAgIGJhZFBhdGNoVG9SZW1vdmVQYXJhZ3JhcGhUYWcodGhpcy5lZGl0ZWREZXNjcmlwdGlvbnMpOwogICAgICB0aGlzLmlzRGlzcGxheWluZ0RpYWxvZ0VkaXRpb25Gb3JtID0gdHJ1ZTsKICAgIH0sCgogIHNhdmVNb2RpZmljYXRpb25zKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCkpIHsKICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmVkaXRlZERlc2NyaXB0aW9ucykuZm9yRWFjaChrZXkgPT4gewogICAgICAgICAgdGhpcy5tZXRhZGF0YS5yZXNvdXJjZURhdGFzZXROYW1lW2tleV0gPSB0aGlzLmVkaXRlZERlc2NyaXB0aW9uc1trZXldOwogICAgICAgIH0pOwogICAgICAgIGNvbnN0IGZvcm1hdGVkRWRpdGVkRGF0YSA9IGZvcm1hdEVkaXRlZERhdGEoCiAgICAgICAgICAicmVzb3VyY2VEYXRhc2V0TmFtZSIsCiAgICAgICAgICB0aGlzLm1ldGFkYXRhLnJlc291cmNlRGF0YXNldE5hbWUKICAgICAgICApOwogICAgICAgIHRoaXMuJGVtaXQoInNlbmRFZGl0ZWREYXRhIiwgZm9ybWF0ZWRFZGl0ZWREYXRhKTsKICAgICAgICB0aGlzLmhpZGVGb3JtKCk7CiAgICAgIH0KICAgIH0sCgogICAgaGlkZUZvcm0oKSB7CiAgICAgIHRoaXMuZWRpdGVkRGVzY3JpcHRpb25zID0gbnVsbDsKICAgICAgdGhpcy5pc0Rpc3BsYXlpbmdEaWFsb2dFZGl0aW9uRm9ybSA9IGZhbHNlOwogICAgfQogIAp9LAogIAp9Cg=="},{"version":3,"sources":["opse-datasetname-block.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA","file":"opse-datasetname-block.vue","sourceRoot":"src/lib/modules/opse-datasetname-block","sourcesContent":["<i18n  >\n{\n  \"en\": {\n    \"opseDatasetName\": \"Dataset name\",\n    \"en\": \"English\",\n    \"fr\": \"French\"\n    \n  },\n  \"fr\": {\n    \"opseDatasetName\": \"Nom du jeu de données\",\n    \"en\": \"Anglais\",\n    \"fr\": \"Français\"\n    \n  }\n}\n</i18n>\n<template>\n  <aeris-metadata-layout\n    v-if=\"isVisible\"\n    :title=\"$t('opseDatasetName')\"\n    :theme=\"theme\"\n    :canDisplayEditIcon=\"canShowEditIcon\"\n    :displayInFlat=\"true\"\n    icon=\"mdi-file\"\n    @edit=\"displayEditionForm()\"\n  >\n  <div v-if=\"metadata.resourceDatasetName\" v-html=\"getResourceDatasetName\"></div>\n  <aeris-metadata-dialog-layout\n    v-if=\"canDisplayEditionForm\"\n    max-width=\"800px\"\n    :is-displaying-dialog=\"isDisplayingDialogEditionForm\"\n    :disable-save-button=\"!isFormValid\"\n    :title=\"$t('opseDatasetName')\"\n    @cancel=\"hideForm()\"\n    @save-modifications=\"saveModifications()\"\n  >\n  <template v-slot:dialog-contents>\n        <v-form ref=\"form\" v-model=\"isFormValid\">\n          <v-tabs>\n            <v-tab\n              v-for=\"(language, index) in Object.keys(metadata.resourceDatasetName)\"\n              :key=\"index\"\n            >{{ $t(language) }}</v-tab>\n            <v-tab-item\n              v-for=\"(language, index) in Object.keys(metadata.resourceDatasetName)\"\n              :key=\"index\"\n            >\n              <v-textarea\n              class=\"pt-2\"\n                v-model=\"editedDescriptions[language]\"\n                outlined\n                hide-details=\"auto\"\n                height=\"650px\"\n                :required=\"language === 'en'\"\n                :rules=\"language === 'en' ? textAreaRules : []\"\n                :label=\"language === 'en' ? 'mandatory' : 'optional'\"\n              ></v-textarea>\n            </v-tab-item>\n          </v-tabs>\n        </v-form>\n      </template>\n  </aeris-metadata-dialog-layout>\n\n  </aeris-metadata-layout>\n</template>\n\n<script>\nimport AerisMetadataLayout from \"../aeris-metadata-ui/aeris-metadata-layout/aeris-metadata-layout.vue\"\nimport AerisMetadataDialogLayout from \"../aeris-metadata-ui/aeris-metadata-layout/aeris-metadata-dialog-layout.vue\";\nimport { applyPrimaryAndSecondaryColors, formatEditedData, badPatchToRemoveParagraphTag } from \"../../utils\";\nimport cloneDeep from \"lodash/cloneDeep\";\nimport marked from \"marked\"\nexport default {\n  name: 'opse-datasetname-block',\n\n  components: {\n    AerisMetadataLayout,\n    AerisMetadataDialogLayout\n  },\n\n  data() {\n    return {\n      isDisplayingDialogEditionForm: false,\n      editedDescriptions:null,\n      isFormValid: true,\n      dialog:false,\n      textAreaRules: [v => !!v || \"Content is required\"],\n\n    }\n  },\n\n  props: {\n    language: {\n      type: String,\n      default: \"en\"\n    },\n    theme: {\n      type: Object,\n      default: () => {\n        return {        \n        primaryColor: \"#F39C12\",\n        secondaryColor: \"#AAA\"};\n      }\n    },\n    service: null,\n    downloadUrl: null,\n    metadata: {\n      type: Object,\n      default: () => {\n        return {};\n      }\n    },\n\n    markdown:{\n      type: Boolean,\n      default: true\n    },\n\n    isEditionAllowed:{\n      type: Boolean,\n      default: false\n    }\n    \n  },\n\n  computed: {\n    applyTheme() {\n      return applyPrimaryAndSecondaryColors(this.theme);\n    },\n\n    isVisible() {\n      const isVisible = this.isEditionAllowed || !!this.getResourceDatasetNames;\n      this.$emit(\"getVisibility\", {\n        name: this.$options.name,\n        programmaticScrollingTitle: this.$t(\"opseDatasetName\"),\n        isVisible\n      });\n      return isVisible;\n    },\n\n   \n    canShowEditIcon() {\n      return this.isEditionAllowed && !this.isDisplayingDialogEditionForm;\n    },\n    canDisplayEditionForm() {\n      return this.isEditionAllowed && this.isDisplayingDialogEditionForm;\n    },\n\n    metadataLanguage(){\n      if (this.metadata){\n        if (this.metadata.language){\n          return this.metadata.language\n        }\n      }\n      return this.language\n    },\n\n   \n    getResourceDatasetName(){\n      let aux = this.getResourceDatasetNames;\n      let result = aux[this.language];\n      if ((!result) || (result.trim().length ==0)){\n        return aux[this.metadataLanguage]\n      }\n      return result;\n    },\n    \n    getResourceDatasetNames() {\n      const resourceDatasetName = cloneDeep(this.metadata.resourceDatasetName);\n      if (resourceDatasetName) {\n        if (this.markdown) {\n          for (let item in resourceDatasetName) {\n            if (resourceDatasetName.hasOwnProperty(item)) {\n              resourceDatasetName[item] = marked(\n                this.addSpaces(resourceDatasetName[item])\n              );\n            }\n          }\n        }\n      }\n      return resourceDatasetName;\n    }\n  },\n\n  watch: {\n    language(value) {\n      this.$i18n.locale = value;\n    }\n  },\n\n  created() {\n   this.$i18n.locale = this.language;\n  },\n\n  \n\n  methods: {\n    \n    addSpaces(value) {\n      let aux = value.replace(/#/g, \"# \");\n      aux = aux.replace(/# #/g, \"##\");\n      aux = aux.replace(/# #/g, \"##\");\n      return aux;\n    },\n  \n\n  displayEditionForm() {\n      if (!this.metadata.resourceDatasetName) {\n        this.$set(this.metadata, \"resourceDatasetName\", {en: \"\", fr: \"\"})\n      }\n      this.editedDescriptions = cloneDeep(this.metadata.resourceDatasetName);\n      badPatchToRemoveParagraphTag(this.editedDescriptions);\n      this.isDisplayingDialogEditionForm = true;\n    },\n\n  saveModifications() {\n      if (this.$refs.form.validate()) {\n        Object.keys(this.editedDescriptions).forEach(key => {\n          this.metadata.resourceDatasetName[key] = this.editedDescriptions[key];\n        });\n        const formatedEditedData = formatEditedData(\n          \"resourceDatasetName\",\n          this.metadata.resourceDatasetName\n        );\n        this.$emit(\"sendEditedData\", formatedEditedData);\n        this.hideForm();\n      }\n    },\n\n    hideForm() {\n      this.editedDescriptions = null;\n      this.isDisplayingDialogEditionForm = false;\n    }\n  \n},\n  \n}\n</script>\n\n<style scoped>\n.theme--light.v-btn.v-btn--icon{\n  color: rgba(0,0,0,.54);\n}\n.theme--light.v-icon {\n    color: var(--primaryColor);\n}\ntheme--light.v-btn {\n  color: var(--primaryColor);\n}\n\n</style>\n"]}]}